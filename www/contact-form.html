<!DOCTYPE html>
<html>
<head>
    <title>Contact Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: auto;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        h1 {
            font-size: 24px;
            margin: 0 0 20px;
            color: #4CAF50;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #4CAF50;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }
    </style>
    <script src="cordova.js"></script>
</head>
<body>
<div class="container">
    <h1 id="form-title">Add Contact</h1>
    <label for="contact-name">Name</label>
    <input type="text" id="contact-name" placeholder="Enter name">
    <label for="contact-phone">Phone</label>
    <input type="text" id="contact-phone" placeholder="Enter phoneNumber">
    <button onclick="saveContact()">Save</button>
</div>

<script>
    document.addEventListener("deviceready", onDeviceReady, false);

    let contactToUpdate = null;

    function onDeviceReady() {
        // Check if there's a contact to update
        const params = new URLSearchParams(window.location.search);
        const contactId = params.get('id');

        if (contactId) {
            document.getElementById('form-title').textContent = 'Update Contact';
            // Fetch the contact details using the ID and populate the form
            navigator.contacts.find(
                ["id", "displayName", "phoneNumbers"],
                function(contacts) {
                    if (contacts.length > 0) {
                        contactToUpdate = contacts[0];
                        document.getElementById('contact-name').value = contactToUpdate.displayName;
                        document.getElementById('contact-phone').value = contactToUpdate.phoneNumbers[0].value;
                    }
                },
                function(error) {
                    alert('Error fetching contact: ' + error.code);
                },
                { filter: contactId, multiple: false }
            );
        }
    }

    function saveContact() {
        const name = document.getElementById('contact-name').value;
        const phone = document.getElementById('contact-phone').value;

        if (contactToUpdate) {
            // Update existing contact
            contactToUpdate.displayName = name;
            contactToUpdate.phoneNumbers[0].value = phone;
            contactToUpdate.save(
                function() { alert('Contact updated successfully!'); window.location = 'index.html'; },
                function(error) { alert('Error updating contact: ' + error.code); }
            );
        } else {
            // Add new contact
            let contact = navigator.contacts.create();
            contact.displayName = name;
            let phoneNumber = new ContactField('mobile', phone, true);
            contact.phoneNumbers = [phoneNumber];
            contact.save(
                function() { alert('Contact added successfully!'); window.location = 'index.html'; },
                function(error) { alert('Error adding contact: ' + error.code); }
            );
        }
    }
</script>
</body>
</html>
